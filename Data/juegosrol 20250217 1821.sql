-- Script was generated by Devart dbForge Studio for MySQL
-- Script date 17/02/2025 18:21:14

-- Deshabilitar claves foráneas temporalmente
SET FOREIGN_KEY_CHECKS = 0;

-- Seleccionar la base de datos
CREATE DATABASE IF NOT EXISTS juegosrol;
USE juegosrol;

-- Eliminar tablas si existen
DROP TABLE IF EXISTS juegan;
DROP TABLE IF EXISTS clases;
DROP TABLE IF EXISTS personajes;
DROP TABLE IF EXISTS jugadores;
DROP TABLE IF EXISTS modulos;
DROP TABLE IF EXISTS partidas;
DROP TABLE IF EXISTS juegos;

-- Crear tabla `juegos`
CREATE TABLE juegos (
  idjuegos INT NOT NULL AUTO_INCREMENT,
  nombre VARCHAR(30) DEFAULT NULL,
  tematica VARCHAR(50) DEFAULT NULL,
  edicion VARCHAR(10) DEFAULT NULL,
  PRIMARY KEY (idjuegos)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- Crear tabla `partidas`
CREATE TABLE partidas (
  idpartidas INT NOT NULL AUTO_INCREMENT,
  idjuegos INT DEFAULT NULL,
  nombre VARCHAR(30) DEFAULT NULL,
  fechainicio DATE DEFAULT NULL,
  fechafin DATE DEFAULT NULL,
  nombre_equipo VARCHAR(20) DEFAULT NULL,
  PRIMARY KEY (idpartidas)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- Crear tabla `modulos`
CREATE TABLE modulos (
  idmodulos INT NOT NULL AUTO_INCREMENT,
  idjuegos INT DEFAULT NULL,
  nombre VARCHAR(50) DEFAULT NULL,
  edicion VARCHAR(10) DEFAULT NULL,
  PRIMARY KEY (idmodulos)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- Crear tabla `jugadores`
CREATE TABLE jugadores (
  idjugadores INT NOT NULL AUTO_INCREMENT,
  nombre VARCHAR(30) DEFAULT NULL,
  rol VARCHAR(20) DEFAULT NULL,
  PRIMARY KEY (idjugadores)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- Crear tabla `personajes`
CREATE TABLE personajes (
  idpersonajes INT NOT NULL AUTO_INCREMENT,
  idjugadores INT DEFAULT NULL,
  nombre VARCHAR(30) DEFAULT NULL,
  master TINYINT(1) DEFAULT NULL,
  PRIMARY KEY (idpersonajes)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- Crear tabla `clases`
CREATE TABLE clases (
  idpersonajes INT NOT NULL,
  clases VARCHAR(20) NOT NULL,
  PRIMARY KEY (idpersonajes, clases)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- Crear tabla `juegan`
CREATE TABLE juegan (
  idjuegan INT NOT NULL AUTO_INCREMENT,
  idpartidas INT DEFAULT NULL,
  idjugadores INT DEFAULT NULL,
  PRIMARY KEY (idjuegan)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- Agregar claves foráneas
ALTER TABLE partidas ADD CONSTRAINT fk_juegos_partidas FOREIGN KEY (idjuegos) REFERENCES juegos (idjuegos);
ALTER TABLE modulos ADD CONSTRAINT fk_juegos_modulos FOREIGN KEY (idjuegos) REFERENCES juegos (idjuegos);
ALTER TABLE personajes ADD CONSTRAINT fk_jugadores_personajes FOREIGN KEY (idjugadores) REFERENCES jugadores (idjugadores);
ALTER TABLE clases ADD CONSTRAINT fk_clases_personajes FOREIGN KEY (idpersonajes) REFERENCES personajes (idpersonajes);
ALTER TABLE juegan ADD CONSTRAINT fk_juegan_jugadores FOREIGN KEY (idjugadores) REFERENCES jugadores (idjugadores);
ALTER TABLE juegan ADD CONSTRAINT fk_juegan_partidas FOREIGN KEY (idpartidas) REFERENCES partidas (idpartidas);

-- Insertar datos en `juegos`
INSERT INTO juegos (idjuegos, nombre, tematica, edicion) VALUES
(1, 'Dungeons & Dragons', 'Fantasía medieval', '5e'),
(2, 'Cyberpunk 2020', 'Ciencia ficción', '2020'),
(3, 'Vampiro: La Mascarada', 'Horror gótico', '20 Anivers'),
(4, 'La Llamada de Cthulhu', 'Terror cósmico', '7a'),
(5, 'Pathfinder', 'Fantasía medieval', '2e');

-- Insertar datos en `partidas`
INSERT INTO partidas (idpartidas, idjuegos, nombre, fechainicio, fechafin, nombre_equipo) VALUES
(1, 1, 'Exploradores de Barovia', '2024-01-01', '2024-03-01', 'Los Valientes'),
(2, 2, 'Hackers en Night City', '2024-02-15', '2024-04-15', 'CyberRunners'),
(3, 3, 'Caza de Sangre', '2024-03-10', '2024-05-10', 'Los Condenados'),
(4, 4, 'Locura en Arkham', '2024-04-20', '2024-06-20', 'Los Inquisitivos'),
(5, 5, 'La última cruzada', '2024-05-05', '2024-07-05', 'Caballeros Perdidos');

-- Insertar datos en `jugadores`
INSERT INTO jugadores (idjugadores, nombre, rol) VALUES
(1, 'Carlos', 'Jugador'),
(2, 'Andrea', 'Master'),
(3, 'Luis', 'Jugador'),
(4, 'Marta', 'Jugador'),
(5, 'Javier', 'Master');

-- Insertar datos en `personajes`
INSERT INTO personajes (idpersonajes, idjugadores, nombre, master) VALUES
(1, 1, 'Thorin Martillo de Hierro', 0),
(2, 2, 'Morgana la Hechicera', 1),
(3, 3, 'Raiden el Asesino', 0),
(4, 4, 'Samantha la Psíquica', 0),
(5, 5, 'Dante el Caballero Oscuro', 1);

-- Insertar datos en `clases`
INSERT INTO clases (idpersonajes, clases) VALUES
(1, 'Bárbaro'),
(1, 'Guerrero'),
(2, 'Mago'),
(3, 'Asesino'),
(4, 'Psíquico'),
(5, 'Caballero Oscuro');

-- Insertar datos en `juegan`
INSERT INTO juegan (idjuegan, idpartidas, idjugadores) VALUES
(1, 1, 1),
(2, 1, 2),
(3, 2, 3),
(4, 2, 4),
(6, 3, 1),
(5, 3, 5),
(7, 4, 2),
(8, 4, 3),
(9, 5, 4),
(10, 5, 5);

-- Restaurar claves foráneas
SET FOREIGN_KEY_CHECKS = 1;
